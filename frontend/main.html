<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/png" href="/PEPEDAWN_thumbnail.png" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="PEPEDAWN Raffle - Legitimate skill-weighted raffle on Sepolia testnet. Contract verified on Etherscan. Gambling involves risk." />
    <title>PEPEDAWN - Ticket Office</title>
    <link rel="stylesheet" href="/src/styles/main.css" />
  </head>
  <body>
    <div id="app">
      <header>
        <h1>PEPEDAWN</h1>
        <button class="hamburger-menu" id="hamburger-menu" aria-label="Toggle navigation menu">
          <span class="hamburger-line"></span>
          <span class="hamburger-line"></span>
          <span class="hamburger-line"></span>
        </button>
        <nav class="main-nav" id="main-nav">
          <a href="/">Home</a>
          <a href="/main.html" class="active">Ticket Office</a>
          <a href="/claim.html">Claim Office</a>
          <a href="/leaderboard.html">Leaderboard</a>
          <a href="/rules.html">Rules</a>
        </nav>
      </header>

      <main>
        <section id="wallet-section">
          <button id="connect-wallet">Connect Wallet</button>
          <div id="wallet-info" style="display: none;">
            <div class="wallet-details">
              <span class="wallet-address" id="wallet-address-display"></span>
              <!-- Debug network indicator - controlled by CONTRACT_CONFIG.DEV_MODE -->
              <span class="wallet-network" id="wallet-network-display" style="opacity: 0.7; font-size: 0.85em;"></span>
              <span class="wallet-balance">Balance: <span id="wallet-balance"></span> ETH</span>
            </div>
          </div>
        </section>

        <section id="round-status">
          <div class="round-header">
            <h2 id="current-round-title">Current Round</h2>
          </div>
          <hr>
          
          <div class="round-content">
            <!-- Left Column: Status Flow (vertical) -->
            <div class="status-column">
              <div class="status-item open-phase" data-status="1">
                <span class="status-icon">ğŸ«</span>
                <span class="status-text">Buy Your Tickets</span>
              </div>
              <div class="status-arrow-vertical">â†“</div>
              <div class="status-row-with-badge">
                <div class="merkle-badge" id="merkle-badge">
                  <div class="badge-icon">ğŸ”</div>
                  <div class="badge-text">Merkle Proof<br>Verified</div>
                </div>
                <div class="status-item drawing-phase" data-status="2,3,4,5">
                  <span class="status-icon">ğŸ²</span>
                  <span class="status-text">Drawing Winners</span>
                </div>
              </div>
              <div class="status-arrow-vertical">â†“</div>
              <div class="status-item claim-phase" data-status="6">
                <span class="status-icon">ğŸ¸</span>
                <span class="status-text">Winners Claiming</span>
              </div>
            </div>
            
            <!-- Right Column: Info + Dispenser -->
            <div class="info-column">
              <div class="info-section-vertical">
                <div class="info-item">
                  <div class="info-header">
                    <span class="info-icon">â°</span>
                    <span class="info-text">Time Remaining</span>
                  </div>
                  <span class="info-value" id="time-remaining">--</span>
                </div>
                <div class="info-section-grid">
                  <div class="info-item">
                    <div class="info-header">
                      <span class="info-icon">ğŸ«</span>
                      <span class="info-text">Total Tickets</span>
                    </div>
                    <span class="info-value" id="total-tickets">--</span>
                  </div>
                  <div class="info-item">
                    <div class="info-header">
                      <span class="info-icon">ğŸ’°</span>
                      <span class="info-text">$ETH</span>
                    </div>
                    <span class="info-value" id="vaulted-eth">--</span>
                  </div>
                </div>
              </div>
              
              <!-- Atomic Dispenser -->
              <div class="dispenser-container">
                <div class="ticket-graphic">
                  <div class="dispenser-label">
                    Atomic Dispenser 
                    <img src="/counterparty.png" alt="XCP" class="xcp-icon-img" onerror="this.style.display='none'">
                  </div>
                  <div class="ticket-icon" data-ticket="1">ğŸ«</div>
                  <div class="ticket-icon" data-ticket="2">ğŸ«</div>
                  <div class="ticket-icon" data-ticket="3">ğŸ«</div>
                  <div class="ticket-icon" data-ticket="4">ğŸ«</div>
                  <div class="ticket-icon" data-ticket="5">ğŸ«</div>
                  <div class="ticket-icon" data-ticket="6">ğŸ«</div>
                  <div class="ticket-icon" data-ticket="7">ğŸ«</div>
                  <div class="ticket-icon" data-ticket="8">ğŸ«</div>
                  <div class="ticket-icon" data-ticket="9">ğŸ«</div>
                  <div class="ticket-icon" data-ticket="10">ğŸ«</div>
                  <div id="dispenser-badge" class="dispenser-badge">
                    <span id="dispenser-text">minimum 10 tickets required</span>
                  </div>
                </div>
              </div>
              
              <!-- Unclaimed Prizes Notification -->
              <div id="unclaimed-prizes-notification" style="display: none;"></div>
            </div>
          </div>
        </section>

        <section id="betting-section">
          <h2>Ticket Counter</h2>
          <svg id="ticket-connector" class="ticket-connector-svg" xmlns="http://www.w3.org/2000/svg">
            <defs>
              <linearGradient id="beam-gradient" x1="0%" y1="0%" x2="100%" y2="0%">
                <stop offset="0%" style="stop-color:#4CAF50;stop-opacity:0" />
                <stop offset="50%" style="stop-color:#4CAF50;stop-opacity:0.8" />
                <stop offset="100%" style="stop-color:#2196F3;stop-opacity:0" />
              </linearGradient>
              <filter id="glow">
                <feGaussianBlur stdDeviation="4" result="coloredBlur"/>
                <feMerge>
                  <feMergeNode in="coloredBlur"/>
                  <feMergeNode in="SourceGraphic"/>
                </feMerge>
              </filter>
            </defs>
            <path id="connector-path" class="connector-path" stroke="url(#beam-gradient)" stroke-width="3" fill="none" filter="url(#glow)"/>
            <!-- Particle tickets -->
            <text class="particle-ticket" font-size="20">ğŸ«</text>
            <text class="particle-ticket" font-size="20">ğŸ«</text>
            <text class="particle-ticket" font-size="20">ğŸ«</text>
          </svg>
          <div id="betting-form" class="betting-layout">
            <div class="ticket-options-column">
              <div class="ticket-option-card" data-tickets="1" data-amount="0.005">
                <div class="ticket-visual">
                  <div class="ticket-single">ğŸ«</div>
                </div>
                <div class="ticket-info">
                  <div class="ticket-label">1 Ticket</div>
                  <div class="ticket-price">0.005 ETH</div>
                </div>
                <div class="ticket-discount"></div>
              </div>
              
              <div class="ticket-option-card" data-tickets="5" data-amount="0.0225">
                <div class="ticket-visual">
                  <div class="ticket-stack">
                    <span class="ticket-stacked">ğŸ«</span>
                    <span class="ticket-stacked">ğŸ«</span>
                    <span class="ticket-stacked">ğŸ«</span>
                    <span class="ticket-stacked">ğŸ«</span>
                    <span class="ticket-stacked">ğŸ«</span>
                  </div>
                </div>
                <div class="ticket-info">
                  <div class="ticket-label">5 Tickets</div>
                  <div class="ticket-price">0.0225 ETH</div>
                </div>
                <div class="ticket-discount">10% off</div>
              </div>
              
              <div class="ticket-option-card" data-tickets="10" data-amount="0.04">
                <div class="ticket-visual">
                  <div class="ticket-bundle">ğŸ“¦</div>
                </div>
                <div class="ticket-info">
                  <div class="ticket-label">10 Tickets</div>
                  <div class="ticket-price">0.04 ETH</div>
                </div>
                <div class="ticket-discount">20% off</div>
              </div>
            </div>
            
            
            <div id="ticket-office" class="ticket-office">
              <div class="raven-background"></div>
              <div class="office-content">
                <div class="summary-card">
                  <div class="summary-item">
                    <span class="summary-icon">ğŸ«</span>
                    <div class="summary-details">
                      <div class="summary-label">Tickets</div>
                      <div class="summary-value" id="selected-tickets">0</div>
                    </div>
                  </div>
                  <div class="summary-item">
                    <span class="summary-icon">ğŸ’°</span>
                    <div class="summary-details">
                      <div class="summary-label">Total Price</div>
                      <div class="summary-value"><span id="selected-amount">0</span> ETH</div>
                    </div>
                  </div>
                  <div class="summary-item">
                    <span class="summary-icon">ğŸ“Š</span>
                    <div class="summary-details">
                      <div class="summary-label">Cap Remaining</div>
                      <div class="summary-value"><span id="cap-remaining">1.0</span> ETH</div>
                    </div>
                  </div>
                </div>
                <button id="buy-tickets" class="btn-buy-tickets">ğŸ¸ Buy Tickets</button>
              </div>
            </div>
            
            <!-- Mobile Purchase Slide-out (hidden on desktop) -->
            <div id="mobile-purchase-slideout" class="mobile-purchase-slideout">
              <div class="mobile-purchase-content">
                <div class="summary-card">
                  <div class="summary-item">
                    <span class="summary-icon">ğŸ«</span>
                    <div class="summary-details">
                      <div class="summary-label">Tickets</div>
                      <div class="summary-value" id="mobile-selected-tickets">0</div>
                    </div>
                  </div>
                  <div class="summary-item">
                    <span class="summary-icon">ğŸ’°</span>
                    <div class="summary-details">
                      <div class="summary-label">Total Price</div>
                      <div class="summary-value"><span id="mobile-selected-amount">0</span> ETH</div>
                    </div>
                  </div>
                  <div class="summary-item">
                    <span class="summary-icon">ğŸ“Š</span>
                    <div class="summary-details">
                      <div class="summary-label">Cap Remaining</div>
                      <div class="summary-value"><span id="mobile-cap-remaining">1.0</span> ETH</div>
                    </div>
                  </div>
                </div>
                <button id="mobile-place-bet" class="btn-buy-tickets">ğŸ¸ Buy Tickets</button>
              </div>
            </div>
          </div>
        </section>

        <section id="proof-section">
          <h2 class="collapsible-header" onclick="toggleProofSection()">
            <span class="collapse-icon">â–¼</span>
            Puzzle Proof Submission
          </h2>
          <div id="proof-form" class="collapsible-content" style="display: none;">
            <p>Submit one puzzle proof per round to get <strong>+40% weight multiplier</strong> on your tickets</p>
            <textarea id="proof-input" placeholder="Paste your puzzle proof here..."></textarea>
            <button id="submit-proof">Submit Proof</button>
            <div id="proof-status"></div>
          </div>
        </section>

        <section id="status-panel">
          <h2>Your Status</h2>
          <div id="user-stats">
            <p>Your Tickets: <span id="user-tickets">0</span></p>
            <p>Your Weight: <span id="user-weight">0</span></p>
            <p>Proof Submitted: <span id="user-proof-status">No</span></p>
            <p>Winning Odds: <span id="user-fake-odds">0%</span></p>
          </div>
        </section>

        <section id="refund-section" style="display: none;">
          <h2>Refunds</h2>
          <div id="refund-container">
            <!-- Refund info will be populated dynamically -->
          </div>
        </section>
      </main>
    </div>

    <script type="module" src="/src/main.js"></script>
  </body>
</html>
